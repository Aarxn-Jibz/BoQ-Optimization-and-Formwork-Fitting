{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useCallback } from \"react\";\nimport { generateChartData, appendChartPoint, generateLogLine, generateBarData, driftMetric } from \"../utils/dataUtils\";\nconst INITIAL_METRICS = {\n  cpu: 67.2,\n  mem: 72.1,\n  rps: 14200,\n  err: 0.003,\n  uptime: 99.98,\n  agents: 3,\n  disk: 54.0,\n  net: 320\n};\n\n/**\n * useLiveMetrics\n * Manages all live-updating metric state and returns data + controls.\n */\nexport function useLiveMetrics(onNewLog) {\n  _s();\n  const [metrics, setMetrics] = useState(INITIAL_METRICS);\n  const [cpuChart, setCpuChart] = useState(() => generateChartData(20, 60, 15));\n  const [memChart, setMemChart] = useState(() => generateChartData(20, 40, 12));\n  const [rpsChart, setRpsChart] = useState(() => generateChartData(20, 55, 20));\n  const [barData, setBarData] = useState(() => generateBarData());\n  const [sparkCpu, setSparkCpu] = useState(() => Array.from({\n    length: 24\n  }, () => Math.random() * 100));\n  const [logs, setLogs] = useState(() => Array.from({\n    length: 10\n  }, generateLogLine).map(l => ({\n    ...l,\n    isNew: false\n  })));\n  const [paused, setPaused] = useState(false);\n  const [tickCount, setTickCount] = useState(0);\n  const addLog = useCallback(log => {\n    setLogs(prev => [{\n      ...log,\n      isNew: true\n    }, ...prev.slice(0, 49)]);\n    if (onNewLog) onNewLog(log);\n  }, [onNewLog]);\n\n  // Metric + chart update every 2s\n  useEffect(() => {\n    if (paused) return;\n    const iv = setInterval(() => {\n      setMetrics(m => ({\n        ...m,\n        cpu: driftMetric(m.cpu, 10, 95, 6),\n        mem: driftMetric(m.mem, 30, 90, 4),\n        rps: driftMetric(m.rps, 5000, 28000, 900),\n        err: driftMetric(m.err, 0, 5, 0.25),\n        net: driftMetric(m.net, 50, 900, 80)\n      }));\n      setCpuChart(appendChartPoint);\n      setMemChart(appendChartPoint);\n      setRpsChart(appendChartPoint);\n      setSparkCpu(d => [...d.slice(1), Math.random() * 100]);\n      setTickCount(t => t + 1);\n    }, 2000);\n    return () => clearInterval(iv);\n  }, [paused]);\n\n  // Log stream every 3.5s\n  useEffect(() => {\n    if (paused) return;\n    const iv = setInterval(() => {\n      addLog(generateLogLine());\n    }, 3500);\n    return () => clearInterval(iv);\n  }, [paused, addLog]);\n\n  // Refresh bar data every 30s\n  useEffect(() => {\n    const iv = setInterval(() => setBarData(generateBarData()), 30000);\n    return () => clearInterval(iv);\n  }, []);\n  const refresh = useCallback(() => {\n    setCpuChart(generateChartData(20, 60, 15));\n    setMemChart(generateChartData(20, 40, 12));\n    setRpsChart(generateChartData(20, 55, 20));\n    setBarData(generateBarData());\n  }, []);\n  return {\n    metrics,\n    cpuChart,\n    memChart,\n    rpsChart,\n    barData,\n    sparkCpu,\n    logs,\n    paused,\n    tickCount,\n    setPaused,\n    addLog,\n    refresh\n  };\n}\n_s(useLiveMetrics, \"SdPV3XMiZIDtl+f8z7i034SOJ3Y=\");","map":{"version":3,"names":["useState","useEffect","useCallback","generateChartData","appendChartPoint","generateLogLine","generateBarData","driftMetric","INITIAL_METRICS","cpu","mem","rps","err","uptime","agents","disk","net","useLiveMetrics","onNewLog","_s","metrics","setMetrics","cpuChart","setCpuChart","memChart","setMemChart","rpsChart","setRpsChart","barData","setBarData","sparkCpu","setSparkCpu","Array","from","length","Math","random","logs","setLogs","map","l","isNew","paused","setPaused","tickCount","setTickCount","addLog","log","prev","slice","iv","setInterval","m","d","t","clearInterval","refresh"],"sources":["C:/Users/JOEL DSILVA/OneDrive/Desktop/Projects/BoQ_Formwork_Fitting/obsidian-core/src/hooks/useLiveMetrics.js"],"sourcesContent":["import { useState, useEffect, useCallback } from \"react\";\nimport {\n  generateChartData,\n  appendChartPoint,\n  generateLogLine,\n  generateBarData,\n  driftMetric,\n} from \"../utils/dataUtils\";\n\nconst INITIAL_METRICS = {\n  cpu:    67.2,\n  mem:    72.1,\n  rps:    14200,\n  err:    0.003,\n  uptime: 99.98,\n  agents: 3,\n  disk:   54.0,\n  net:    320,\n};\n\n/**\n * useLiveMetrics\n * Manages all live-updating metric state and returns data + controls.\n */\nexport function useLiveMetrics(onNewLog) {\n  const [metrics,   setMetrics]   = useState(INITIAL_METRICS);\n  const [cpuChart,  setCpuChart]  = useState(() => generateChartData(20, 60, 15));\n  const [memChart,  setMemChart]  = useState(() => generateChartData(20, 40, 12));\n  const [rpsChart,  setRpsChart]  = useState(() => generateChartData(20, 55, 20));\n  const [barData,   setBarData]   = useState(() => generateBarData());\n  const [sparkCpu,  setSparkCpu]  = useState(() => Array.from({ length: 24 }, () => Math.random() * 100));\n  const [logs,      setLogs]      = useState(() => Array.from({ length: 10 }, generateLogLine).map((l) => ({ ...l, isNew: false })));\n  const [paused,    setPaused]    = useState(false);\n  const [tickCount, setTickCount] = useState(0);\n\n  const addLog = useCallback((log) => {\n    setLogs((prev) => [{ ...log, isNew: true }, ...prev.slice(0, 49)]);\n    if (onNewLog) onNewLog(log);\n  }, [onNewLog]);\n\n  // Metric + chart update every 2s\n  useEffect(() => {\n    if (paused) return;\n    const iv = setInterval(() => {\n      setMetrics((m) => ({\n        ...m,\n        cpu: driftMetric(m.cpu, 10, 95, 6),\n        mem: driftMetric(m.mem, 30, 90, 4),\n        rps: driftMetric(m.rps, 5000, 28000, 900),\n        err: driftMetric(m.err, 0, 5, 0.25),\n        net: driftMetric(m.net, 50, 900, 80),\n      }));\n      setCpuChart(appendChartPoint);\n      setMemChart(appendChartPoint);\n      setRpsChart(appendChartPoint);\n      setSparkCpu((d) => [...d.slice(1), Math.random() * 100]);\n      setTickCount((t) => t + 1);\n    }, 2000);\n    return () => clearInterval(iv);\n  }, [paused]);\n\n  // Log stream every 3.5s\n  useEffect(() => {\n    if (paused) return;\n    const iv = setInterval(() => {\n      addLog(generateLogLine());\n    }, 3500);\n    return () => clearInterval(iv);\n  }, [paused, addLog]);\n\n  // Refresh bar data every 30s\n  useEffect(() => {\n    const iv = setInterval(() => setBarData(generateBarData()), 30000);\n    return () => clearInterval(iv);\n  }, []);\n\n  const refresh = useCallback(() => {\n    setCpuChart(generateChartData(20, 60, 15));\n    setMemChart(generateChartData(20, 40, 12));\n    setRpsChart(generateChartData(20, 55, 20));\n    setBarData(generateBarData());\n  }, []);\n\n  return {\n    metrics, cpuChart, memChart, rpsChart, barData,\n    sparkCpu, logs, paused, tickCount,\n    setPaused, addLog, refresh,\n  };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}